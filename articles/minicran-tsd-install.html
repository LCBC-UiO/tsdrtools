<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Installing packages on TSD from mini-CRAN • tsdrtools</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Installing packages on TSD from mini-CRAN">
<meta property="og:description" content="tsdrtools">
<meta property="og:image" content="/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tsdrtools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/tsdrtools.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/minicran-tsd-install.html">Installing packages on TSD from mini-CRAN</a>
    </li>
    <li>
      <a href="../articles/rstudio-tsd-install.html">Installing RStudio on TSD</a>
    </li>
    <li>
      <a href="../articles/slurm-setup.html">Using R-packages in SLURM scripts</a>
    </li>
    <li>
      <a href="../articles/tidyverse-tsd-install.html">Installing the Tidyverse on TSD</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/LCBC-UiO/tsdrtools/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Installing packages on TSD from mini-CRAN</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/LCBC-UiO/tsdrtools/blob/master/vignettes/minicran-tsd-install.Rmd"><code>vignettes/minicran-tsd-install.Rmd</code></a></small>
      <div class="hidden name"><code>minicran-tsd-install.Rmd</code></div>

    </div>

    
    
<p>USIT periodically downloads packages from CRAN, Bioconductor and a couple other repositories into TSD for easy install by users. However, by default, R is set up to look for repositories online (i.e. CRAN), which is not available on TSD because it is an offline server (you have no internet access inside TSD). To be able to connect to the downloaded repository within TSD and install packages, you need to change where the <code><a href="https://rdrr.io/r/utils/install.packages.html">install.packages()</a></code> function looks for packages within TSD.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"Y"</span>, <span class="kw">repos</span> <span class="kw">=</span> <span class="st">"https://cran.tsd.usit.no"</span>)</pre></body></html></div>
<p>USIT has placed the mini-CRAN repository at <a href="https://cran.tsd.usit.no" class="uri">https://cran.tsd.usit.no</a> within TSD, and therefore supplying <code>repos = "https://cran.tsd.usit.no"</code> to the install function will connect you there instead of failed attempts to CRAN.</p>
<p>Installing packages are not usually one-time things though. Usually we have quite some packages we want to install, and try different packages to get our work done. It’s inconvenient to have to remember the link within TSD where the package-repo is.</p>
<p>It is therefore recommended to place in a file called <code>$HOME/.Rprofile</code> the following information:</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/eval.html">local</a></span>({
       <span class="no">r</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html">getOption</a></span>(<span class="st">"repos"</span>)
       <span class="no">r</span>[<span class="st">"CRAN"</span>] <span class="kw">&lt;-</span> <span class="st">"https://cran.tsd.usit.no"</span>
       <span class="no">r</span>[<span class="st">"BIOCONDUCTOR"</span>] <span class="kw">&lt;-</span> <span class="st">"https://bioconductor.tsd.usit.no"</span>
       <span class="no">r</span>[<span class="st">"BIOCONDUCTOR-annotation"</span>] <span class="kw">&lt;-</span> <span class="st">"https://bioconductor.tsd.usit.no/data/annotation"</span>
       <span class="no">r</span>[<span class="st">"BIOCONDUCTOR-experiment"</span>] <span class="kw">&lt;-</span> <span class="st">"https://bioconductor.tsd.usit.no/data/experiment"</span>
       <span class="no">r</span>[<span class="st">"BioC_mirror"</span>] <span class="kw">&lt;-</span> <span class="st">"https://bioconductor.tsd.usit.no"</span>
       <span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span>(<span class="kw">repos</span><span class="kw">=</span><span class="no">r</span>)
       <span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span>(<span class="kw">BIOCONDUCTOR_ONLINE_VERSION_DIAGNOSIS</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
       <span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span>(<span class="kw">download.file.method</span> <span class="kw">=</span> <span class="st">"libcurl"</span>)
       })</pre></body></html></div>
<p>if you do not yet have a <code>$HOME/.Rprofile</code> file, create it in the terminal by:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="co"># create file</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="fu">touch</span> <span class="va">$HOME</span>/.Rprofile</a>
<a class="sourceLine" id="cb3-3" data-line-number="3"></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="co"># open to edit</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="ex">gedit</span> <span class="va">$HOME</span>/.Rprofile</a></code></pre></div>
<p>Restarting R will now mean <code><a href="https://rdrr.io/r/utils/install.packages.html">install.packages()</a></code> always looks for new packages you ask for in the two CRAN and Bioconductor repositories available within TSD.</p>
<p>For more information about R packages installs, see <a href="https://www.uio.no/english/services/it/research/sensitive-data/use-tsd/software/r/index.html">official USIT support pages for R</a></p>
<div id="when-installs-from-mini-cran-fail" class="section level1">
<h1 class="hasAnchor">
<a href="#when-installs-from-mini-cran-fail" class="anchor"></a>When installs from mini-CRAN fail</h1>
<p>If your install fails from within TSD even with these settings, there are usually one of two culprits:</p>
<ol style="list-style-type: decimal">
<li>There are other system requirements not yet met (linux libs or c++ compilers missing)<br>
</li>
<li>The package requires internett to install, because it the package itself does not contain all the necessary information (like stringi)</li>
</ol>
<div id="solving-problem-1" class="section level2">
<h2 class="hasAnchor">
<a href="#solving-problem-1" class="anchor"></a>Solving problem 1</h2>
<div id="system-libs-missing" class="section level3">
<h3 class="hasAnchor">
<a href="#system-libs-missing" class="anchor"></a>system libs missing</h3>
<p>If there are other system requirements needed, your packages will fail installation with messages looking something like so :</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="no">configure</span>: <span class="no">error</span>: <span class="st">"libxml not found"</span></pre></body></html></div>
<p>TSD runs what is called minimal-install Linux operative systems. This means there are quite some system libraries that certain R-packages use that are not available by default. Thankfully, USIT are very helpful in getting these installed and available upon request. Annoyingly, the package installs will fail at the first system requirement not met, and as such, you might need several rounds with IT untill all necessary libs are installed.</p>
</div>
<div id="clang-missing" class="section level3">
<h3 class="hasAnchor">
<a href="#clang-missing" class="anchor"></a>Clang missing</h3>
<p>Another possible error you will see, would be some error relating to <code>clang</code> or <code>cpp</code> compiler missing. This means that the package you want to install has some c++ (another programming language) dependency, and it cannot find a compiler for that language. Thankfully, you can easily connect to a c++ compiler through the TSD software modules.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="ex">module</span> load gcc</a></code></pre></div>
<p>By loading in <code>gcc</code> (GNU c++ compiler) <em>before</em> starting R, this problem is solved. We highly recommend creating a <code>.bash_profile</code> in your home directory that automatically loads in <code>gcc</code> for you at terminal start-up if you regularly use R-packages that require it.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="co"># create file</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="fu">touch</span> <span class="va">$HOME</span>/.bash_profile</a>
<a class="sourceLine" id="cb6-3" data-line-number="3"></a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="co"># open to edit</span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="ex">gedit</span> <span class="va">$HOME</span>/.bash_profile</a></code></pre></div>
<p>Add</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="co">#!/bin/bash</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2"></a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="co"># load gcc for R-pkgs</span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="ex">module</span> load gcc</a></code></pre></div>
<p>save and restart your terminal. <code>gcc</code> should now always be available when you start R from the terminal.</p>
</div>
</div>
<div id="solving-problem-2" class="section level2">
<h2 class="hasAnchor">
<a href="#solving-problem-2" class="anchor"></a>Solving problem 2</h2>
<p>The tsdrtools package is specifically made to handle problem no. 2. By using <code><a href="../reference/tsd_package_prepare.html">tsd_package_prepare()</a></code> outside TSD, the function will download your wanted package pluss all its dependencies into a zip-folder. This folder can be transferred into TSD, and installed using the function <code><a href="../reference/tsd_package_install.html">tsd_package_install()</a></code>, on the zip-folder imported.</p>
<p>This should install your package into your main library path.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Athanasia Mo Mowinckel.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
